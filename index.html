<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Class A CDL Pre-Trip Inspection Study Tool - Interactive flashcards with audio support">
    <meta name="theme-color" content="#FF6B2C">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PreTrip CDL">
    <title>Pre-Trip Inspection Flashcards</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23FF6B2C'/%3E%3Ctext x='50' y='50' dominant-baseline='middle' text-anchor='middle' font-family='Arial Black' font-size='60' fill='%23FFC933'%3Eâœ“%3C/text%3E%3C/svg%3E">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Work+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --safety-orange: #FF6B2C;
            --road-yellow: #FFC933;
            --steel-gray: #2C3E50;
            --concrete: #95A5A6;
            --asphalt: #1a1a1a;
            --white-line: #ECF0F1;
            --caution-red: #E74C3C;
            --success-green: #27AE60;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, var(--asphalt) 0%, var(--steel-gray) 100%);
            min-height: 100vh;
            color: var(--white-line);
            overflow-x: hidden;
        }

        /* Animated background pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(90deg, transparent, transparent 50px, rgba(255,255,255,0.03) 50px, rgba(255,255,255,0.03) 52px),
                repeating-linear-gradient(0deg, transparent, transparent 50px, rgba(255,255,255,0.03) 50px, rgba(255,255,255,0.03) 52px);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            animation: slideDown 0.6s ease-out;
        }

        .install-prompt {
            display: none;
            margin: 15px auto;
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--safety-orange), #ff8c5a);
            border: 3px solid var(--road-yellow);
            color: var(--asphalt);
            font-family: 'Work Sans', sans-serif;
            font-weight: 700;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(255, 107, 44, 0.4);
            transition: all 0.3s ease;
        }

        .install-prompt:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 44, 0.6);
        }

        .install-prompt::before {
            content: 'ðŸ“² ';
            font-size: 1.2rem;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            letter-spacing: 3px;
            color: var(--safety-orange);
            text-shadow: 3px 3px 0 rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 0.9rem;
            color: var(--road-yellow);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            animation: fadeIn 0.8s ease-out 0.2s both;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .btn {
            flex: 1;
            min-width: 140px;
            padding: 12px 20px;
            border: 3px solid var(--safety-orange);
            background: var(--steel-gray);
            color: var(--white-line);
            font-family: 'Work Sans', sans-serif;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--safety-orange);
            transition: left 0.3s ease;
            z-index: -1;
        }

        .btn:hover::before {
            left: 0;
        }

        .btn:hover {
            color: var(--asphalt);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 44, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.active {
            background: var(--safety-orange);
            color: var(--asphalt);
            border-color: var(--road-yellow);
        }

        select {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 3px solid var(--concrete);
            background: var(--steel-gray);
            color: var(--white-line);
            font-family: 'Work Sans', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        select:hover {
            border-color: var(--safety-orange);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--steel-gray);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
            animation: fadeIn 0.8s ease-out 0.3s both;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--safety-orange), var(--road-yellow));
            width: 0%;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .card-container {
            perspective: 1000px;
            margin-bottom: 30px;
            animation: fadeIn 0.8s ease-out 0.4s both;
        }

        .card {
            position: relative;
            width: 100%;
            height: 500px;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border: 4px solid var(--safety-orange);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .card-front {
            background: linear-gradient(135deg, var(--steel-gray) 0%, #34495e 100%);
        }

        .card-back {
            background: linear-gradient(135deg, #34495e 0%, var(--steel-gray) 100%);
            transform: rotateY(180deg);
        }

        .card-section {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.1rem;
            color: var(--road-yellow);
            letter-spacing: 2px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--safety-orange);
        }

        .card-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2rem;
            color: var(--white-line);
            margin-bottom: 20px;
            line-height: 1.2;
            letter-spacing: 1px;
        }

        .card-image {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            min-height: 200px;
            border: 2px dashed var(--concrete);
        }

        .card-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        .card-image.placeholder {
            color: var(--concrete);
            font-size: 3rem;
        }

        .card-content {
            flex: 1;
            overflow-y: auto;
            color: var(--white-line);
            font-size: 1rem;
            line-height: 1.6;
        }

        .card-content ul {
            list-style: none;
            padding-left: 0;
        }

        .card-content li {
            padding-left: 25px;
            position: relative;
            margin-bottom: 12px;
        }

        .card-content li::before {
            content: 'â–¸';
            position: absolute;
            left: 0;
            color: var(--safety-orange);
            font-size: 1.2rem;
        }

        .card-content strong {
            color: var(--road-yellow);
            font-weight: 700;
        }

        .tap-hint {
            text-align: center;
            color: var(--concrete);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 15px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .navigation {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            animation: fadeIn 0.8s ease-out 0.5s both;
        }

        .nav-btn {
            flex: 1;
            padding: 15px;
            border: 3px solid var(--safety-orange);
            background: var(--asphalt);
            color: var(--white-line);
            font-family: 'Work Sans', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            border-color: var(--concrete);
        }

        .nav-btn:not(:disabled):hover {
            background: var(--safety-orange);
            color: var(--asphalt);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 107, 44, 0.4);
        }

        .card-counter {
            text-align: center;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.3rem;
            color: var(--road-yellow);
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        .mastery-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            animation: fadeIn 0.8s ease-out 0.6s both;
        }

        .mastery-btn {
            padding: 10px 20px;
            border: 2px solid var(--success-green);
            background: transparent;
            color: var(--success-green);
            font-family: 'Work Sans', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .mastery-btn.mastered {
            background: var(--success-green);
            color: var(--asphalt);
        }

        .mastery-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.4);
        }

        .audio-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border: 3px solid var(--road-yellow);
            background: var(--steel-gray);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.5rem;
        }

        .audio-btn:hover {
            background: var(--road-yellow);
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 4px 15px rgba(255, 201, 51, 0.4);
        }

        .audio-btn.playing {
            animation: soundWave 0.5s infinite;
        }

        @keyframes soundWave {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .stats {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            animation: fadeIn 0.8s ease-out 0.7s both;
        }

        .stat-box {
            flex: 1;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border: 2px solid var(--concrete);
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2rem;
            color: var(--safety-orange);
            letter-spacing: 1px;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--concrete);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }
            
            .card {
                height: 450px;
            }
            
            .card-face {
                padding: 20px;
            }
            
            .card-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Pre-Trip Inspection</h1>
            <div class="subtitle">Class A CDL Flashcards</div>
            <button class="install-prompt" id="installButton">Install App</button>
        </header>

        <div class="controls">
            <select id="sectionFilter">
                <option value="all">All Sections</option>
                <option value="In-Cab">In-Cab</option>
                <option value="Engine Start">Engine Start (G-LABS)</option>
                <option value="Brake Tests">Brake Tests</option>
                <option value="Light Check">Light Check</option>
                <option value="Engine Compartment">Engine Compartment</option>
                <option value="Steering Axle">Steering Axle</option>
                <option value="Side of Vehicle">Side of Vehicle</option>
                <option value="Coupling">Coupling</option>
                <option value="Trailer">Trailer</option>
            </select>
            <button class="btn" id="quizMode">Quiz Mode</button>
            <button class="btn" id="autoPlayAudio">Auto Audio: OFF</button>
        </div>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-value" id="masteredCount">0</div>
                <div class="stat-label">Mastered</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">Total Cards</div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="card-counter" id="cardCounter">Card 1 of 1</div>

        <div class="card-container">
            <div class="card" id="flashcard">
                <div class="card-face card-front">
                    <div class="card-section" id="frontSection">Section</div>
                    <div class="card-title" id="frontTitle">Loading...</div>
                    <div class="card-image placeholder" id="frontImage">ðŸ“·</div>
                    <div class="tap-hint">TAP TO REVEAL INSPECTION POINTS</div>
                </div>
                <div class="card-face card-back">
                    <button class="audio-btn" id="audioBtn">ðŸ”Š</button>
                    <div class="card-section" id="backSection">Section</div>
                    <div class="card-title" id="backTitle">Title</div>
                    <div class="card-content" id="backContent">Content</div>
                    <div class="tap-hint">TAP TO RETURN</div>
                </div>
            </div>
        </div>

        <div class="mastery-toggle">
            <button class="mastery-btn" id="masteryBtn">Mark as Mastered âœ“</button>
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn">â—„ Previous</button>
            <button class="nav-btn" id="nextBtn">Next â–º</button>
        </div>
    </div>

    <script>
        // IMAGE GUIDE:
        // To add photos, replace null with the image path or URL
        // You can use:
        // 1. Adobe Stock images - download and reference: "images/filename.jpg"
        // 2. Your own photos - reference: "images/filename.jpg"
        // 3. External URLs - use: "https://example.com/image.jpg"
        //
        // RECOMMENDED PHOTOS TO TAKE OR SOURCE:
        // - Lug nuts (close-up showing rust streaks)
        // - Tire tread with depth gauge
        // - Air brake hose connections
        // - 5th wheel/kingpin coupling
        // - Landing gear
        // - Glad hands (air line connectors)
        // - Brake drum/lining
        // - Mirrors
        // - Windshield with inspection sticker
        // - Fire extinguisher
        // - Emergency triangles
        // - Coolant reservoir
        // - Oil dipstick
        // - Power steering reservoir
        // - Steering linkage
        // - Battery
        // - Fuel/DEF tank caps
        // - Reflective tape on trailer
        // - Trailer lights
        
        // Flashcard data based on the pre-trip inspection guide
        const flashcards = [
            // Engine Start - G-LABS
            {
                section: "Engine Start",
                title: "Governor Cut Out",
                front: "Governor Cut Out",
                back: "Start engine and wait for governor to cut out. Announce cutout pressure (should be 120-140 PSI).",
                image: null
            },
            {
                section: "Engine Start",
                title: "Air Leaks Test",
                front: "Air Leaks Test",
                back: "Turn engine off, key to ON. Place in low gear, release brakes. Fully apply foot brake and hold 1 minute. Air pressure should drop no more than 4 PSI.",
                image: null
            },
            {
                section: "Engine Start",
                title: "Alarms",
                front: "Low Air Pressure Alarms",
                back: "Fan the brakes. Audio and visual alarms should activate above 55 PSI.",
                image: null
            },
            {
                section: "Engine Start",
                title: "Protection Valves",
                front: "Tractor Protection Valves",
                back: "Continue fanning brakes. Between 20-45 PSI, trailer brake and tractor protection valves should pop out.",
                image: null
            },

            // In-Cab
            {
                section: "In-Cab",
                title: "Horns",
                front: "Horn Check",
                back: "Activate both city horn and air horn. Both should function properly.",
                image: "images/horns.jpg"
            },
            {
                section: "In-Cab",
                title: "Heater & Defrost",
                front: "Heater & Defrost",
                back: "Fan works properly. Vents air to windshield and floor.",
                image: "images/heater-defrost.jpg"
            },
            {
                section: "In-Cab",
                title: "Wipers & Washers",
                front: "Wipers & Washers",
                back: "Wiper arms and blades are PMS (Properly Mounted & Secure), not damaged or torn. Wipers and washers operate smoothly and properly.",
                image: "images/wipers-washers-ezgif.com-optimize.gif"
            },
            {
                section: "In-Cab",
                title: "Windshield",
                front: "Windshield Inspection",
                back: "Clean, with no damage or obstructions except for inspection sticker.",
                image: null
            },
            {
                section: "In-Cab",
                title: "Mirrors",
                front: "Traffic Monitoring Devices",
                back: "Mirrors are clean and adjusted properly.",
                image: "images/mirrors.jpg"
            },
            {
                section: "In-Cab",
                title: "Emergency Equipment",
                front: "Emergency Equipment",
                back: "Fire extinguisher (PMS, fully charged). 3 emergency triangles. 6 spare fuses.",
                image: null
            },
            {
                section: "In-Cab",
                title: "Lighting Indicators",
                front: "Dashboard Indicators",
                back: "Key to ON position. Check DEF & ABS lights. Demonstrate indicators: Left, Right, High Beam, 4-way flashers.",
                image: "images/dashboard-indicators-ezgif.com-optimize.gif"
            },

            // Brake Tests
            {
                section: "Brake Tests",
                title: "Parking Brake - Trailer",
                front: "Trailer Parking Brake Test",
                back: "Build air pressure until alarms stop. Release tractor brake, apply trailer brake. Gently pull forward - trailer brake should hold.",
                image: null
            },
            {
                section: "Brake Tests",
                title: "Parking Brake - Tractor",
                front: "Tractor Parking Brake Test",
                back: "Release trailer brake, engage tractor brake. Gently pull forward - tractor brake should hold.",
                image: null
            },
            {
                section: "Brake Tests",
                title: "Service Brakes",
                front: "Service Brake Test",
                back: "Release brakes. Pull forward to 5 MPH. Apply foot brake - vehicle should not pull to either side and should stop properly.",
                image: null
            },

            // Light Check
            {
                section: "Light Check",
                title: "Front Lights",
                front: "Front & Side Light Check",
                back: "Ask examiner to check lights. Demonstrate: Low beams, High beams, Left turn, Right turn, 4-ways, Clearance lights.",
                image: null
            },
            {
                section: "Light Check",
                title: "Rear Lights",
                front: "Rear Light Check",
                back: "Ask examiner to walk to trailer rear. Demonstrate: Taillights, Brake lights, Left turn, Right turn, 4-ways, Clearance lights.",
                image: null
            },

            // Engine Compartment
            {
                section: "Engine Compartment",
                title: "Lenses & Reflectors",
                front: "Front Lenses",
                back: "Light lenses and reflectors proper color, clean, not broken, not missing. Include clearance, headlights, turn signals, 4-ways.",
                image: "images/front-lenses.jpg"
            },
            {
                section: "Engine Compartment",
                title: "Fluid & Air Leaks",
                front: "Leak Check",
                back: "No visible or audible leaks. No puddles on ground. No dripping fluids. All hoses and air lines have no ABC (Abrasion, Bulges, Cuts) and are not leaking.",
                image: "images/fluid-air-leaks-drivers.gif"
            },
            {
                section: "Engine Compartment",
                title: "Coolant Reservoir",
                front: "Coolant Level",
                back: "PMS, not CBL (Cracked, Broken, Loose). Fluid between add and fill line. Not leaking.",
                image: "images/coolant-reservoir.gif"
            },
            {
                section: "Engine Compartment",
                title: "Oil Level",
                front: "Engine Oil",
                back: "Check dipstick - level between add and full line.",
                image: "images/oil-level.jpg"
            },
            {
                section: "Engine Compartment",
                title: "Power Steering Fluid",
                front: "Power Steering Reservoir",
                back: "PMS, fluid between add and fill line. No ABC in hoses. Not leaking.",
                image: "images/power-steering-level.jpg"
            },
            {
                section: "Engine Compartment",
                title: "Steering Gear Box",
                front: "Steering Gear Box & Hoses",
                back: "PMS, no ABC in hoses or lines. Nuts/bolts tight. Not leaking.",
                image: "images/steering-gearbox.jpg"
            },
            {
                section: "Engine Compartment",
                title: "Steering Linkage",
                front: "Steering Linkage",
                back: "PMS, not CBL. All castle nuts and cotter pins in place.",
                image: null
            },

            // Steering Axle
            {
                section: "Steering Axle",
                title: "Tires",
                front: "Tire Inspection",
                back: "Evenly worn tread, at least 4/32\" depth (checked with gauge). No ABC on sidewalls. Valve stem not leaking, cap present. Properly inflated (checked with pressure gauge).",
                image: null
            },
            {
                section: "Steering Axle",
                title: "Rims",
                front: "Wheel Rims",
                back: "Not CBL. No illegal welds.",
                image: "images/wheel-rims.jpg"
            },
            {
                section: "Steering Axle",
                title: "Lug Nuts",
                front: "Lug Nut Check",
                back: "All present and tight. No rust streaks or shiny threads indicating looseness.",
                image: "images/lug-nuts.jpg"
            },
            {
                section: "Steering Axle",
                title: "Springs & Shocks",
                front: "Suspension Components",
                back: "Springs, mounts, & shocks PMS, not CBL. No missing parts. Springs not shifted. Shock absorber not damaged or leaking.",
                image: "images/springs-shocks-ezgif.com-optimize.gif"
            },
            {
                section: "Steering Axle",
                title: "Air Brake Hose",
                front: "Brake Air Lines",
                back: "PMS, no ABC, not leaking.",
                image: "images/air-brake-hose.jpg"
            },
            {
                section: "Steering Axle",
                title: "Brake Contaminates",
                front: "Brake Cleanliness",
                back: "Drum and lining have no dirt, oil, or grease.",
                image: "images/brake-contaminates.jpg"
            },

            // Side of Vehicle
            {
                section: "Side of Vehicle",
                title: "Side Lenses",
                front: "Side Lights & Reflectors",
                back: "Proper color, clean, not broken, not missing. Include clearance, turn signals, ABS, rear marker on trailer.",
                image: "images/side-of-vehicle-lenses.jpg"
            },
            {
                section: "Side of Vehicle",
                title: "Side Mirrors",
                front: "Mirror Condition",
                back: "PMS, not CBL, and clean.",
                image: "images/side-mirrors.jpg"
            },
            {
                section: "Side of Vehicle",
                title: "Battery",
                front: "Battery Inspection",
                back: "PMS, no loose/frayed wires, no excessive corrosion.",
                image: "images/battery.jpg"
            },
            {
                section: "Side of Vehicle",
                title: "Fuel Tanks",
                front: "Fuel & DEF Tanks",
                back: "PMS, caps tight, not leaking.",
                image: "images/fuel-tanks.jpg"
            },
            {
                section: "Side of Vehicle",
                title: "Tractor Frame",
                front: "Tractor Frame Integrity",
                back: "No cracks, welds, or holes other than from manufacturer.",
                image: "images/tractor-frame.jpg"
            },
            {
                section: "Side of Vehicle",
                title: "Trailer Frame",
                front: "Trailer Frame & Floor",
                back: "Frame/cross members: No cracks, welds, or holes other than from manufacturer. No cracks or holes in floor.",
                image: "images/trailer-frame.jpg"
            },
            {
                section: "Side of Vehicle",
                title: "Tandem Release",
                front: "Tandem Slide Mechanism",
                back: "Tandem release lever/valve & slide pins PMS, not CBL. Pins and valve/release handle in locked position.",
                image: "images/tandem-release.jpg"
            },

            // Coupling
            {
                section: "Coupling",
                title: "Air & Electrical Lines",
                front: "Trailer Connections",
                back: "PMS to tractor, no ABC, no exposed wires, not tangled or rubbing. PMS to trailer. Glad hands and grommets in good condition, not leaking.",
                image: "images/air-electrical-lines-ezgif.com-optimize.gif"
            },
            {
                section: "Coupling",
                title: "5th Wheel",
                front: "5th Wheel Skid Plate",
                back: "PMS, not CBL, properly greased.",
                image: "images/fifth-wheel.jpg"
            },
            {
                section: "Coupling",
                title: "Kingpin & Gap",
                front: "Kingpin/Apron/Gap",
                back: "Apron and kingpin not CBL. No gap between apron and skid plate.",
                image: "images/apron.jpg"
            },
            {
                section: "Coupling",
                title: "Locking Jaws",
                front: "5th Wheel Locking Jaws",
                back: "Locking jaws fully secured around kingpin with no excessive wear.",
                image: "images/locking-jaws.jpg"
            },
            {
                section: "Coupling",
                title: "Release Handle",
                front: "5th Wheel Release Handle",
                back: "Release arm is PMS and engaged in the locked position.",
                image: "images/release-handle.jpg"
            },
            {
                section: "Coupling",
                title: "5th Wheel Slide Pins",
                front: "5th Wheel Slide Pins",
                back: "5th wheel slide pins are not CBL and are engaged in the locked position.",
                image: "images/fifth-wheel-locking-pins.jpg"
            },

            // Trailer
            {
                section: "Trailer",
                title: "Landing Gear",
                front: "Landing Gear & Clearance",
                back: "PMS, frame and landing pads not CBL. Landing pads raised, crank handle secure. Landing gear will clear tractor frame while turning.",
                image: "images/landing-gear.jpg"
            },
            {
                section: "Trailer",
                title: "Reflective Tape",
                front: "DOT Reflective Tape",
                back: "Reflective tape on sides and rear of trailer present and mounted securely.",
                image: "images/reflective-tape.jpg"
            },
            {
                section: "Trailer",
                title: "Rear Lenses",
                front: "Trailer Rear Lights",
                back: "Proper color, clean, not broken, not missing. Include clearance, turn signals, 4-ways, taillights, brake lights.",
                image: "images/trailer-rear-lenses.jpg"
            }
        ];

        // Application state
        let currentIndex = 0;
        let filteredCards = [...flashcards];
        let isFlipped = false;
        let quizMode = false;
        let autoPlayAudio = false;
        let masteredCards = new Set();

        // Load saved progress from localStorage
        function loadProgress() {
            const saved = localStorage.getItem('preTripProgress');
            if (saved) {
                masteredCards = new Set(JSON.parse(saved));
            }
        }

        // Save progress to localStorage
        function saveProgress() {
            localStorage.setItem('preTripProgress', JSON.stringify([...masteredCards]));
        }

        // Elements
        const card = document.getElementById('flashcard');
        const frontSection = document.getElementById('frontSection');
        const frontTitle = document.getElementById('frontTitle');
        const frontImage = document.getElementById('frontImage');
        const backSection = document.getElementById('backSection');
        const backTitle = document.getElementById('backTitle');
        const backContent = document.getElementById('backContent');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const cardCounter = document.getElementById('cardCounter');
        const sectionFilter = document.getElementById('sectionFilter');
        const quizModeBtn = document.getElementById('quizMode');
        const audioBtn = document.getElementById('audioBtn');
        const autoPlayBtn = document.getElementById('autoPlayAudio');
        const masteryBtn = document.getElementById('masteryBtn');
        const progressFill = document.getElementById('progressFill');
        const masteredCount = document.getElementById('masteredCount');
        const totalCount = document.getElementById('totalCount');

        // Text-to-speech function
        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1;
                utterance.volume = 1;
                
                audioBtn.classList.add('playing');
                utterance.onend = () => {
                    audioBtn.classList.remove('playing');
                };
                
                window.speechSynthesis.speak(utterance);
            }
        }

        // Update card display
        function updateCard() {
            if (filteredCards.length === 0) return;

            const currentCard = filteredCards[currentIndex];
            
            // Update front
            frontSection.textContent = currentCard.section;
            frontTitle.textContent = currentCard.front;
            
            // Update back
            backSection.textContent = currentCard.section;
            backTitle.textContent = currentCard.title;
            backContent.innerHTML = `<p>${currentCard.back}</p>`;
            
            // Update counter
            cardCounter.textContent = `Card ${currentIndex + 1} of ${filteredCards.length}`;
            
            // Update navigation buttons
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex === filteredCards.length - 1;
            
            // Update mastery button
            const cardId = `${currentCard.section}-${currentCard.title}`;
            if (masteredCards.has(cardId)) {
                masteryBtn.classList.add('mastered');
                masteryBtn.textContent = 'Mastered âœ“';
            } else {
                masteryBtn.classList.remove('mastered');
                masteryBtn.textContent = 'Mark as Mastered âœ“';
            }
            
            // Reset flip state
            if (isFlipped) {
                card.classList.remove('flipped');
                isFlipped = false;
            }
            
            updateStats();
        }

        // Update statistics
        function updateStats() {
            masteredCount.textContent = masteredCards.size;
            totalCount.textContent = flashcards.length;
            
            const progress = (masteredCards.size / flashcards.length) * 100;
            progressFill.style.width = `${progress}%`;
        }

        // Filter cards by section
        function filterCards() {
            const selectedSection = sectionFilter.value;
            
            if (selectedSection === 'all') {
                filteredCards = [...flashcards];
            } else {
                filteredCards = flashcards.filter(card => card.section === selectedSection);
            }
            
            if (quizMode) {
                shuffleCards();
            }
            
            currentIndex = 0;
            updateCard();
        }

        // Shuffle cards for quiz mode
        function shuffleCards() {
            for (let i = filteredCards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [filteredCards[i], filteredCards[j]] = [filteredCards[j], filteredCards[i]];
            }
        }

        // Toggle quiz mode
        function toggleQuizMode() {
            quizMode = !quizMode;
            if (quizMode) {
                quizModeBtn.classList.add('active');
                quizModeBtn.textContent = 'Quiz Mode: ON';
                shuffleCards();
            } else {
                quizModeBtn.classList.remove('active');
                quizModeBtn.textContent = 'Quiz Mode: OFF';
                filterCards();
            }
            currentIndex = 0;
            updateCard();
        }

        // Toggle auto-play audio
        function toggleAutoPlayAudio() {
            autoPlayAudio = !autoPlayAudio;
            if (autoPlayAudio) {
                autoPlayBtn.classList.add('active');
                autoPlayBtn.textContent = 'Auto Audio: ON';
            } else {
                autoPlayBtn.classList.remove('active');
                autoPlayBtn.textContent = 'Auto Audio: OFF';
            }
        }

        // Toggle mastery status
        function toggleMastery() {
            const currentCard = filteredCards[currentIndex];
            const cardId = `${currentCard.section}-${currentCard.title}`;
            
            if (masteredCards.has(cardId)) {
                masteredCards.delete(cardId);
            } else {
                masteredCards.add(cardId);
            }
            
            saveProgress();
            updateCard();
        }

        // Card flip
        card.addEventListener('click', (e) => {
            if (e.target === audioBtn) return;
            
            isFlipped = !isFlipped;
            card.classList.toggle('flipped');
            
            if (isFlipped && autoPlayAudio) {
                const currentCard = filteredCards[currentIndex];
                speak(currentCard.back);
            }
        });

        // Audio button
        audioBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const currentCard = filteredCards[currentIndex];
            speak(currentCard.back);
        });

        // Navigation
        prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                updateCard();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentIndex < filteredCards.length - 1) {
                currentIndex++;
                updateCard();
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                prevBtn.click();
            } else if (e.key === 'ArrowRight') {
                nextBtn.click();
            } else if (e.key === ' ') {
                e.preventDefault();
                card.click();
            }
        });

        // Controls
        sectionFilter.addEventListener('change', filterCards);
        quizModeBtn.addEventListener('click', toggleQuizMode);
        autoPlayBtn.addEventListener('click', toggleAutoPlayAudio);
        masteryBtn.addEventListener('click', toggleMastery);

        // Initialize
        loadProgress();
        updateCard();

        // PWA Installation
        let deferredPrompt;
        const installButton = document.getElementById('installButton');

        // Listen for beforeinstallprompt event
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            // Show install button
            installButton.style.display = 'block';
        });

        // Handle install button click
        installButton.addEventListener('click', async () => {
            if (!deferredPrompt) {
                return;
            }
            // Show the install prompt
            deferredPrompt.prompt();
            // Wait for the user to respond to the prompt
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response to the install prompt: ${outcome}`);
            // Clear the deferredPrompt
            deferredPrompt = null;
            // Hide install button
            installButton.style.display = 'none';
        });

        // Hide install button if app is already installed
        window.addEventListener('appinstalled', () => {
            installButton.style.display = 'none';
            deferredPrompt = null;
            console.log('PWA was installed');
        });

        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registration successful:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
